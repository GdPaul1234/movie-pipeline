# How to generate resources for the `segments_detector` tests?

## 1. Generating the video

1. Install and launch [stable-diffusion-webui-docker
](https://github.com/AbdBarho/stable-diffusion-webui-docker) and follows instructions to install AUTOMATIC1111.

2. Download the [playground-v2.fp16.safetensors](https://huggingface.co/playgroundai/playground-v2-1024px-aesthetic/blob/main/playground-v2.fp16.safetensors) Stable Diffusion checkpoint and puts it under `#{stable-diffusion-webui-docker folder}/data/models/Stable-diffusion`.

3. Install the [sd-webui-deforum](https://github.com/deforum-art/sd-webui-deforum) extension.

4. Go to the `Deforum` tab, fill in the `Settings File` input with the path of `tests\movie_pipeline\ressources\features\segments_detector\20240728202517_settings.txt`, then click on `Load all settings`.

5. Click on `Generate` and copy the video under this folder.

## 2. Generating the audio

1. Install and launch [MusicGPT](https://github.com/gabotechs/MusicGPT). It will take some times to load the first time because it downloads the model for generating audio from text prompt.

2. Follows these prompt partially generated by Llama3.1:8b:

> **Introduction (5 seconds, music_001.wav)**
>
> * Prompt : "A background music that is engaging and optimistic, with a touch of joy and confidence. A light rhythm and airy melody. Use the following instruments: piano, acoustic guitar, flute, and light sound effects to give a sense of openness."
> * Generate a 5-second background music with these characteristics.
>
>
> **Publicity 1 (5 seconds, music_002.wav)**
>
> * Prompt : "A product music that helps achieve well-being. A energetic and motivating rhythm, with a mix of percussion and synths to give an impression of effectiveness. Use the following instruments: drums, electric bass, keyboards, and sound effects to add a touch of power."
> * Generate a 5-second product music with these characteristics.
>
> **Main Content (10 seconds, music_003.wav)**
>
> * Prompt : "A music that reflects the experiences and advice of the person. A slower and more melancholic rhythm, with a mix of acoustic instruments to give an impression of intimacy. Use the following instruments: piano, acoustic guitar, and light sound effects to add a touch of personality."
> * Generate a 10-second main content music with these characteristics.
>
> **Publicity 2 (5 seconds, music_004.wav)**
>
> * Prompt : "A product music that helps achieve well-being, but with a calmer and more peaceful tone. Use the following instruments: drums, electric bass, keyboards, and sound effects to add a touch of serenity."
> * Generate a 5-second product music with these characteristics.
>
> **Conclusion (5 seconds, music_005.wav)**
>
> * Prompt : "A slightly modified version of the initial background music, but with a more confident and motivating tone. Use the following instruments: piano, acoustic guitar, and light sound effects to give a sense of success."
> * Generate a 5-second background music with these characteristics.

## 3. Generating dialogs

TODO

## 4. Adding logo and ad breaks

## 5. Edit and render the videos

Open `segments_detector test video.kdenlive` in Kdenlive, then render the video.

Move the rendered video in `tests\movie_pipeline\ressources\features\segments_detector\segments_detector test video.mp4`
